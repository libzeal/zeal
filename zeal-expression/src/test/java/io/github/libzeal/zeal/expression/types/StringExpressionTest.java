package io.github.libzeal.zeal.expression.types;

import io.github.libzeal.zeal.expression.test.ExpressionTestCaseBuilder;

import static io.github.libzeal.zeal.expression.evaluation.Result.FAILED;
import static io.github.libzeal.zeal.expression.evaluation.Result.PASSED;

class StringExpressionTest extends ObjectExpressionTest<String, StringExpression> {

    @Override
    protected StringExpression expression(String value) {
        return new StringExpression(value);
    }

    @Override
    protected String exampleValue1() {
        return "foo";
    }

    @Override
    protected String exampleValue2() {
        return "bar";
    }

    @Override
    protected void extendTestCases(ExpressionTestCaseBuilder<String, StringExpression> builder) {
        isEmptyTestCases(builder);
        isNotEmptyTestCases(builder);
        isBlankTestCases(builder);
        isNotBlankTestCases(builder);
        hasLengthOfTestCases(builder);
        isLongerThanTestCases(builder);
        isLongerThanOrEqualToTestCases(builder);
        isShorterThanTestCases(builder);
        isShorterThanOrEqualToTestCases(builder);
        includesTestCases(builder);
        excludesTestCases(builder);
        occursTestCases(builder);
        occursMoreThanTestCases(builder);
        occursMoreThanOrEqualToTestCases(builder);
        occursLessThanTestCases(builder);
        occursLessThanOrEqualToTestCases(builder);
        startsWithTestCases(builder);
        doesNotStartWithTestCases(builder);
        endsWithTestCases(builder);
        doesNotEndWithTestCases(builder);
        matchesTestCases(builder);
        doesNotMatchTestCases(builder);
        isCaseInsensitiveEqualToTestCases(builder);
        hasAtIndexTestCases(builder);
        doesNotHaveAtIndexTestCase(builder);
        hasAtLastIndexTestCases(builder);
        doesNotHaveAtLastIndexTestCases(builder);
    }

    private void isEmptyTestCases(ExpressionTestCaseBuilder<String, StringExpression> builder) {
        builder.newTest((expression, value) -> expression.isEmpty())
                .value("a")
                .expectedState(FAILED)
                .expectedName("isEmpty")
                .expectedExpectedValue("true")
                .expectedActualValue("false")
                .addTest()
            .newTest((expression, value) -> expression.isEmpty())
                .value("")
                .expectedState(PASSED)
                .expectedName("isEmpty")
                .expectedExpectedValue("true")
                .expectedActualValue("true")
                .addTest()
            .newTest((expression, value) -> expression.isEmpty())
                .value(" ")
                .expectedState(FAILED)
                .expectedName("isEmpty")
                .expectedExpectedValue("true")
                .expectedActualValue("false")
                .addTest();
    }

    private void isNotEmptyTestCases(ExpressionTestCaseBuilder<String, StringExpression> builder) {
        builder.newTest((expression, value) -> expression.isNotEmpty())
                .value("a")
                .expectedState(PASSED)
                .expectedName("isNotEmpty")
                .expectedExpectedValue("true")
                .expectedActualValue("true")
                .addTest()
            .newTest((expression, value) -> expression.isNotEmpty())
                .value("")
                .expectedState(FAILED)
                .expectedName("isNotEmpty")
                .expectedExpectedValue("true")
                .expectedActualValue("false")
                .addTest()
            .newTest((expression, value) -> expression.isNotEmpty())
                .value(" ")
                .expectedState(PASSED)
                .expectedName("isNotEmpty")
                .expectedExpectedValue("true")
                .expectedActualValue("true")
                .addTest();
    }

    private void isBlankTestCases(ExpressionTestCaseBuilder<String, StringExpression> builder) {
        builder.newTest((expression, value) -> expression.isBlank())
                .value("a")
                .expectedState(FAILED)
                .expectedName("isBlank")
                .expectedExpectedValue("true")
                .expectedActualValue("false")
                .addTest()
            .newTest((expression, value) -> expression.isBlank())
                .value("")
                .expectedState(PASSED)
                .expectedName("isBlank")
                .expectedExpectedValue("true")
                .expectedActualValue("true")
                .addTest()
            .newTest((expression, value) -> expression.isBlank())
                .value(" ")
                .expectedState(PASSED)
                .expectedName("isBlank")
                .expectedExpectedValue("true")
                .expectedActualValue("true")
                .addTest();
    }

    private void isNotBlankTestCases(ExpressionTestCaseBuilder<String, StringExpression> builder) {
        builder.newTest((expression, value) -> expression.isNotBlank())
                .value("a")
                .expectedState(PASSED)
                .expectedName("isNotBlank")
                .expectedExpectedValue("true")
                .expectedActualValue("true")
                .addTest()
            .newTest((expression, value) -> expression.isNotBlank())
                .value("")
                .expectedState(FAILED)
                .expectedName("isNotBlank")
                .expectedExpectedValue("true")
                .expectedActualValue("false")
                .addTest()
            .newTest((expression, value) -> expression.isNotBlank())
                .value(" ")
                .expectedState(FAILED)
                .expectedName("isNotBlank")
                .expectedExpectedValue("true")
                .expectedActualValue("false")
                .addTest();
    }

    private void hasLengthOfTestCases(ExpressionTestCaseBuilder<String, StringExpression> builder) {
        builder.newTest((expression, value) -> expression.hasLengthOf(1))
                .value("a")
                .expectedState(PASSED)
                .expectedName("hasLengthOf[1]")
                .expectedExpectedValue("length := 1")
                .expectedActualValue("length := 1")
                .addTest()
            .newTest((expression, value) -> expression.hasLengthOf(1))
                .value("")
                .expectedState(FAILED)
                .expectedName("hasLengthOf[1]")
                .expectedExpectedValue("length := 1")
                .expectedActualValue("length := 0")
                .addTest()
            .newTest((expression, value) -> expression.hasLengthOf(1))
                .value("aa")
                .expectedState(FAILED)
                .expectedName("hasLengthOf[1]")
                .expectedExpectedValue("length := 1")
                .expectedActualValue("length := 2")
                .addTest();
    }

    private void isLongerThanTestCases(ExpressionTestCaseBuilder<String, StringExpression> builder) {
        builder.newTest((expression, value) -> expression.isLongerThan(1))
                .value("a")
                .expectedState(FAILED)
                .expectedName("isLongerThan[1]")
                .expectedExpectedValue("length > 1")
                .expectedActualValue("length := 1")
                .addTest()
            .newTest((expression, value) -> expression.isLongerThan(1))
                .value("")
                .expectedState(FAILED)
                .expectedName("isLongerThan[1]")
                .expectedExpectedValue("length > 1")
                .expectedActualValue("length := 0")
                .addTest()
            .newTest((expression, value) -> expression.isLongerThan(1))
                .value("aa")
                .expectedState(PASSED)
                .expectedName("isLongerThan[1]")
                .expectedExpectedValue("length > 1")
                .expectedActualValue("length := 2")
                .addTest();
    }

    private void isLongerThanOrEqualToTestCases(ExpressionTestCaseBuilder<String, StringExpression> builder) {
        builder.newTest((expression, value) -> expression.isLongerThanOrEqualTo(1))
                .value("a")
                .expectedState(PASSED)
                .expectedName("isLongerThanOrEqualTo[1]")
                .expectedExpectedValue("length >= 1")
                .expectedActualValue("length := 1")
                .addTest()
            .newTest((expression, value) -> expression.isLongerThanOrEqualTo(1))
                .value("")
                .expectedState(FAILED)
                .expectedName("isLongerThanOrEqualTo[1]")
                .expectedExpectedValue("length >= 1")
                .expectedActualValue("length := 0")
                .addTest()
            .newTest((expression, value) -> expression.isLongerThanOrEqualTo(1))
                .value("aa")
                .expectedState(PASSED)
                .expectedName("isLongerThanOrEqualTo[1]")
                .expectedExpectedValue("length >= 1")
                .expectedActualValue("length := 2")
                .addTest();
    }

    private void isShorterThanTestCases(ExpressionTestCaseBuilder<String, StringExpression> builder) {
        builder.newTest((expression, value) -> expression.isShorterThan(1))
                .value("a")
                .expectedState(FAILED)
                .expectedName("isShorterThan[1]")
                .expectedExpectedValue("length < 1")
                .expectedActualValue("length := 1")
                .addTest()
            .newTest((expression, value) -> expression.isShorterThan(1))
                .value("")
                .expectedState(PASSED)
                .expectedName("isShorterThan[1]")
                .expectedExpectedValue("length < 1")
                .expectedActualValue("length := 0")
                .addTest()
            .newTest((expression, value) -> expression.isShorterThan(1))
                .value("aa")
                .expectedState(FAILED)
                .expectedName("isShorterThan[1]")
                .expectedExpectedValue("length < 1")
                .expectedActualValue("length := 2")
                .addTest();
    }

    private void isShorterThanOrEqualToTestCases(ExpressionTestCaseBuilder<String, StringExpression> builder) {
        builder.newTest((expression, value) -> expression.isShorterThanOrEqualTo(1))
                .value("a")
                .expectedState(PASSED)
                .expectedName("isShorterThanOrEqualTo[1]")
                .expectedExpectedValue("length <= 1")
                .expectedActualValue("length := 1")
                .addTest()
            .newTest((expression, value) -> expression.isShorterThanOrEqualTo(1))
                .value("")
                .expectedState(PASSED)
                .expectedName("isShorterThanOrEqualTo[1]")
                .expectedExpectedValue("length <= 1")
                .expectedActualValue("length := 0")
                .addTest()
            .newTest((expression, value) -> expression.isShorterThanOrEqualTo(1))
                .value("aa")
                .expectedState(FAILED)
                .expectedName("isShorterThanOrEqualTo[1]")
                .expectedExpectedValue("length <= 1")
                .expectedActualValue("length := 2")
                .addTest();
    }

    private void includesTestCases(ExpressionTestCaseBuilder<String, StringExpression> builder) {
        builder.newTest((expression, value) -> expression.includes('a'))
                .value("ab")
                .expectedState(PASSED)
                .expectedName("includes[a]")
                .expectedExpectedValue("includes[a]")
                .expectedActualValue("includes[a]")
                .expectedHint("'a' found at index 0")
                .addTest()
            .newTest((expression, value) -> expression.includes('a'))
                .value("b")
                .expectedState(FAILED)
                .expectedName("includes[a]")
                .expectedExpectedValue("includes[a]")
                .expectedActualValue("excludes[a]")
                .expectedHint("String does not include 'a'")
                .addTest()
            .newTest((expression, value) -> expression.includes("a"))
                .value("ab")
                .expectedState(PASSED)
                .expectedName("includes[a]")
                .expectedExpectedValue("includes[a]")
                .expectedActualValue("includes[a]")
                .expectedHint("\"a\" found at index 0")
                .addTest()
            .newTest((expression, value) -> expression.includes("a"))
                .value("b")
                .expectedState(FAILED)
                .expectedName("includes[a]")
                .expectedExpectedValue("includes[a]")
                .expectedActualValue("excludes[a]")
                .expectedHint("String does not include \"a\"")
                .addTest();
    }

    private void excludesTestCases(ExpressionTestCaseBuilder<String, StringExpression> builder) {
        builder.newTest((expression, value) -> expression.excludes('a'))
                .value("ab")
                .expectedState(FAILED)
                .expectedName("excludes[a]")
                .expectedExpectedValue("excludes[a]")
                .expectedActualValue("includes[a]")
                .expectedHint("'a' found at index 0")
                .addTest()
            .newTest((expression, value) -> expression.excludes('a'))
                .value("b")
                .expectedState(PASSED)
                .expectedName("excludes[a]")
                .expectedExpectedValue("excludes[a]")
                .expectedActualValue("excludes[a]")
                .expectedHint("String does not include 'a'")
                .addTest()
            .newTest((expression, value) -> expression.excludes("a"))
                .value("ab")
                .expectedState(FAILED)
                .expectedName("excludes[a]")
                .expectedExpectedValue("excludes[a]")
                .expectedActualValue("includes[a]")
                .expectedHint("\"a\" found at index 0")
                .addTest()
            .newTest((expression, value) -> expression.excludes("a"))
                .value("b")
                .expectedState(PASSED)
                .expectedName("excludes[a]")
                .expectedExpectedValue("excludes[a]")
                .expectedActualValue("excludes[a]")
                .expectedHint("String does not include \"a\"")
                .addTest();
    }

    private void occursTestCases(ExpressionTestCaseBuilder<String, StringExpression> builder) {
        builder.newTest((expression, value) -> expression.occurs('a', 1))
                .value("ab")
                .expectedState(PASSED)
                .expectedName("occurs[a] := 1")
                .expectedExpectedValue("occurrences := 1")
                .expectedActualValue("occurrences := 1")
                .addTest()
            .newTest((expression, value) -> expression.occurs('a', 1))
                .value("aab")
                .expectedState(FAILED)
                .expectedName("occurs[a] := 1")
                .expectedExpectedValue("occurrences := 1")
                .expectedActualValue("occurrences := 2")
                .addTest()
            .newTest((expression, value) -> expression.occurs('a', 1))
                .value("b")
                .expectedState(FAILED)
                .expectedName("occurs[a] := 1")
                .expectedExpectedValue("occurrences := 1")
                .expectedActualValue("occurrences := 0")
                .addTest();
    }

    private void occursMoreThanTestCases(ExpressionTestCaseBuilder<String, StringExpression> builder) {
        builder.newTest((expression, value) -> expression.occursMoreThan('a', 1))
                .value("ab")
                .expectedState(FAILED)
                .expectedName("occurs[a] > 1")
                .expectedExpectedValue("occurrences > 1")
                .expectedActualValue("occurrences := 1")
                .addTest()
            .newTest((expression, value) -> expression.occursMoreThan('a', 1))
                .value("aab")
                .expectedState(PASSED)
                .expectedName("occurs[a] > 1")
                .expectedExpectedValue("occurrences > 1")
                .expectedActualValue("occurrences := 2")
                .addTest()
            .newTest((expression, value) -> expression.occursMoreThan('a', 1))
                .value("b")
                .expectedState(FAILED)
                .expectedName("occurs[a] > 1")
                .expectedExpectedValue("occurrences > 1")
                .expectedActualValue("occurrences := 0")
                .addTest();
    }

    private void occursMoreThanOrEqualToTestCases(ExpressionTestCaseBuilder<String, StringExpression> builder) {
        builder.newTest((expression, value) -> expression.occursMoreThanOrEqualTo('a', 1))
                .value("ab")
                .expectedState(PASSED)
                .expectedName("occurs[a] >= 1")
                .expectedExpectedValue("occurrences >= 1")
                .expectedActualValue("occurrences := 1")
                .addTest()
            .newTest((expression, value) -> expression.occursMoreThanOrEqualTo('a', 1))
                .value("aab")
                .expectedState(PASSED)
                .expectedName("occurs[a] >= 1")
                .expectedExpectedValue("occurrences >= 1")
                .expectedActualValue("occurrences := 2")
                .addTest()
            .newTest((expression, value) -> expression.occursMoreThanOrEqualTo('a', 1))
                .value("b")
                .expectedState(FAILED)
                .expectedName("occurs[a] >= 1")
                .expectedExpectedValue("occurrences >= 1")
                .expectedActualValue("occurrences := 0")
                .addTest();
    }

    private void occursLessThanTestCases(ExpressionTestCaseBuilder<String, StringExpression> builder) {
        builder.newTest((expression, value) -> expression.occursLessThan('a', 1))
                .value("ab")
                .expectedState(FAILED)
                .expectedName("occurs[a] < 1")
                .expectedExpectedValue("occurrences < 1")
                .expectedActualValue("occurrences := 1")
                .addTest()
            .newTest((expression, value) -> expression.occursLessThan('a', 1))
                .value("aab")
                .expectedState(FAILED)
                .expectedName("occurs[a] < 1")
                .expectedExpectedValue("occurrences < 1")
                .expectedActualValue("occurrences := 2")
                .addTest()
            .newTest((expression, value) -> expression.occursLessThan('a', 1))
                .value("b")
                .expectedState(PASSED)
                .expectedName("occurs[a] < 1")
                .expectedExpectedValue("occurrences < 1")
                .expectedActualValue("occurrences := 0")
                .addTest();
    }

    private void occursLessThanOrEqualToTestCases(ExpressionTestCaseBuilder<String, StringExpression> builder) {
        builder.newTest((expression, value) -> expression.occursLessThanOrEqualTo('a', 1))
                .value("ab")
                .expectedState(PASSED)
                .expectedName("occurs[a] <= 1")
                .expectedExpectedValue("occurrences <= 1")
                .expectedActualValue("occurrences := 1")
                .addTest()
            .newTest((expression, value) -> expression.occursLessThanOrEqualTo('a', 1))
                .value("aab")
                .expectedState(FAILED)
                .expectedName("occurs[a] <= 1")
                .expectedExpectedValue("occurrences <= 1")
                .expectedActualValue("occurrences := 2")
                .addTest()
            .newTest((expression, value) -> expression.occursLessThanOrEqualTo('a', 1))
                .value("b")
                .expectedState(PASSED)
                .expectedName("occurs[a] <= 1")
                .expectedExpectedValue("occurrences <= 1")
                .expectedActualValue("occurrences := 0")
                .addTest();
    }

    private void startsWithTestCases(ExpressionTestCaseBuilder<String, StringExpression> builder) {
        builder.newTest((expression, value) -> expression.startsWith("aa"))
                .value("bbaa")
                .expectedState(FAILED)
                .expectedName("startsWith[aa]")
                .expectedExpectedValue("startsWith[aa]")
                .expectedActualValue("bbaa")
                .addTest()
            .newTest((expression, value) -> expression.startsWith("aa"))
                .value("aabb")
                .expectedState(PASSED)
                .expectedName("startsWith[aa]")
                .expectedExpectedValue("startsWith[aa]")
                .expectedActualValue("aabb")
                .addTest();
    }

    private void doesNotStartWithTestCases(ExpressionTestCaseBuilder<String, StringExpression> builder) {
        builder.newTest((expression, value) -> expression.doesNotStartWith("aa"))
                .value("bbaa")
                .expectedState(PASSED)
                .expectedName("doesNotStartWith[aa]")
                .expectedExpectedValue("not[startsWith[aa]]")
                .expectedActualValue("bbaa")
                .addTest()
            .newTest((expression, value) -> expression.doesNotStartWith("aa"))
                .value("aabb")
                .expectedState(FAILED)
                .expectedName("doesNotStartWith[aa]")
                .expectedExpectedValue("not[startsWith[aa]]")
                .expectedActualValue("aabb")
                .addTest();
    }

    private void endsWithTestCases(ExpressionTestCaseBuilder<String, StringExpression> builder) {
        builder.newTest((expression, value) -> expression.endsWith("aa"))
                .value("bbaa")
                .expectedState(PASSED)
                .expectedName("endsWith[aa]")
                .expectedExpectedValue("endsWith[aa]")
                .expectedActualValue("bbaa")
                .addTest()
            .newTest((expression, value) -> expression.endsWith("aa"))
                .value("aabb")
                .expectedState(FAILED)
                .expectedName("endsWith[aa]")
                .expectedExpectedValue("endsWith[aa]")
                .expectedActualValue("aabb")
                .addTest();
    }

    private void doesNotEndWithTestCases(ExpressionTestCaseBuilder<String, StringExpression> builder) {
        builder.newTest((expression, value) -> expression.doesNotEndWith("aa"))
                .value("bbaa")
                .expectedState(FAILED)
                .expectedName("doesNotEndWith[aa]")
                .expectedExpectedValue("not[endsWith[aa]]")
                .expectedActualValue("bbaa")
                .addTest()
            .newTest((expression, value) -> expression.doesNotEndWith("aa"))
                .value("aabb")
                .expectedState(PASSED)
                .expectedName("doesNotEndWith[aa]")
                .expectedExpectedValue("not[endsWith[aa]]")
                .expectedActualValue("aabb")
                .addTest();
    }

    private void matchesTestCases(ExpressionTestCaseBuilder<String, StringExpression> builder) {
        builder.newTest((expression, value) -> expression.matches("a*b"))
                .value("aab")
                .expectedState(PASSED)
                .expectedName("matches[a*b]")
                .expectedExpectedValue("matches[a*b]")
                .expectedActualValue("aab")
                .addTest()
            .newTest((expression, value) -> expression.matches("a*b"))
                .value("ccc")
                .expectedState(FAILED)
                .expectedName("matches[a*b]")
                .expectedExpectedValue("matches[a*b]")
                .expectedActualValue("ccc")
                .addTest();
    }

    private void doesNotMatchTestCases(ExpressionTestCaseBuilder<String, StringExpression> builder) {
        builder.newTest((expression, value) -> expression.doesNotMatch("a*b"))
                .value("aab")
                .expectedState(FAILED)
                .expectedName("doesNotMatch[a*b]")
                .expectedExpectedValue("not[matches[a*b]]")
                .expectedActualValue("aab")
                .addTest()
            .newTest((expression, value) -> expression.doesNotMatch("a*b"))
                .value("ccc")
                .expectedState(PASSED)
                .expectedName("doesNotMatch[a*b]")
                .expectedExpectedValue("not[matches[a*b]]")
                .expectedActualValue("ccc")
                .addTest();
    }

    private void isCaseInsensitiveEqualToTestCases(ExpressionTestCaseBuilder<String, StringExpression> builder) {
        builder.newTest((expression, value) -> expression.isCaseInsensitiveEqualTo("foo"))
                .value("foo")
                .expectedState(PASSED)
                .expectedName("caseInsensitiveEqualTo[foo]")
                .expectedExpectedValue("foo")
                .expectedActualValue("foo")
                .addTest()
            .newTest((expression, value) -> expression.isCaseInsensitiveEqualTo("Foo"))
                .value("foo")
                .expectedState(PASSED)
                .expectedName("caseInsensitiveEqualTo[Foo]")
                .expectedExpectedValue("Foo")
                .expectedActualValue("foo")
                .addTest()
            .newTest((expression, value) -> expression.isCaseInsensitiveEqualTo("bar"))
                .value("foo")
                .expectedState(FAILED)
                .expectedName("caseInsensitiveEqualTo[bar]")
                .expectedExpectedValue("bar")
                .expectedActualValue("foo")
                .addTest();
    }

    private void hasAtIndexTestCases(ExpressionTestCaseBuilder<String, StringExpression> builder) {
        builder.newTest((expression, value) -> expression.hasAtIndex('c', 0))
                .testCaseName("[hasAtIndex:char] Has letter but not at index")
                .value("abc")
                .expectedState(FAILED)
                .expectedName("indexOf[" + 'c' + "] := " + 0)
                .expectedExpectedValue("0")
                .expectedActualValue("2")
                .addTest()
            .newTest((expression, value) -> expression.hasAtIndex('c', 0))
                .testCaseName("[hasAtIndex:char] Has letter at index")
                .value("cba")
                .expectedState(PASSED)
                .expectedName("indexOf[" + 'c' + "] := " + 0)
                .expectedExpectedValue("0")
                .expectedActualValue("0")
                .addTest()
            .newTest((expression, value) -> expression.hasAtIndex('z', 0))
                .testCaseName("[hasAtIndex:char] Does not have letter")
                .value("cba")
                .expectedState(FAILED)
                .expectedName("indexOf[" + 'z' + "] := " + 0)
                .expectedExpectedValue("0")
                .expectedActualValue("-1")
                .addTest()
            .newTest((expression, value) -> expression.hasAtIndex('c', 0))
                .testCaseName("[hasAtIndex:char] First index matches")
                .value("cabc")
                .expectedState(PASSED)
                .expectedName("indexOf[" + 'c' + "] := " + 0)
                .expectedExpectedValue("0")
                .expectedActualValue("0")
                .addTest()
            .newTest((expression, value) -> expression.hasAtIndex("c", 0))
                .testCaseName("[hasAtIndex:char] Has letter but not at index")
                .value("abc")
                .expectedState(FAILED)
                .expectedName("indexOf[" + 'c' + "] := " + 0)
                .expectedExpectedValue("0")
                .expectedActualValue("2")
                .addTest()
            .newTest((expression, value) -> expression.hasAtIndex("c", 0))
                .testCaseName("[hasAtIndex:string] Has letter at index")
                .value("cba")
                .expectedState(PASSED)
                .expectedName("indexOf[" + 'c' + "] := " + 0)
                .expectedExpectedValue("0")
                .expectedActualValue("0")
                .addTest()
            .newTest((expression, value) -> expression.hasAtIndex("z", 0))
                .testCaseName("[hasAtIndex:string] Does not have letter")
                .value("cba")
                .expectedState(FAILED)
                .expectedName("indexOf[" + 'z' + "] := " + 0)
                .expectedExpectedValue("0")
                .expectedActualValue("-1")
                .addTest()
            .newTest((expression, value) -> expression.hasAtIndex("c", 0))
                .testCaseName("[hasAtIndex:string] First index matches")
                .value("cabc")
                .expectedState(PASSED)
                .expectedName("indexOf[" + 'c' + "] := " + 0)
                .expectedExpectedValue("0")
                .expectedActualValue("0")
                .addTest();
    }

    private void doesNotHaveAtIndexTestCase(ExpressionTestCaseBuilder<String, StringExpression> builder) {
        builder.newTest((expression, value) -> expression.doesNotHaveAtIndex('c', 0))
                .testCaseName("[doesNotHaveAtIndex:char] Has letter but not at index")
                .value("abc")
                .expectedState(PASSED)
                .expectedName("indexOf[" + 'c' + "] != " + 0)
                .expectedExpectedValue("not[0]")
                .expectedActualValue("2")
                .addTest()
            .newTest((expression, value) -> expression.doesNotHaveAtIndex('c', 0))
                .testCaseName("[doesNotHaveAtIndex:char] Has letter at index")
                .value("cba")
                .expectedState(FAILED)
                .expectedName("indexOf[" + 'c' + "] != " + 0)
                .expectedExpectedValue("not[0]")
                .expectedActualValue("0")
                .addTest()
            .newTest((expression, value) -> expression.doesNotHaveAtIndex('z', 0))
                .testCaseName("[doesNotHaveAtIndex:char] Does not have letter")
                .value("cba")
                .expectedState(PASSED)
                .expectedName("indexOf[" + 'z' + "] != " + 0)
                .expectedExpectedValue("not[0]")
                .expectedActualValue("-1")
                .addTest()
            .newTest((expression, value) -> expression.doesNotHaveAtIndex('c', 0))
                .testCaseName("[doesNotHaveAtIndex:char] First index matches")
                .value("cabc")
                .expectedState(FAILED)
                .expectedName("indexOf[" + 'c' + "] != " + 0)
                .expectedExpectedValue("not[0]")
                .expectedActualValue("0")
                .addTest()
            .newTest((expression, value) -> expression.doesNotHaveAtIndex("c", 0))
                .testCaseName("[doesNotHaveAtIndex:string] Has letter but not at index")
                .value("abc")
                .expectedState(PASSED)
                .expectedName("indexOf[" + 'c' + "] != " + 0)
                .expectedExpectedValue("not[0]")
                .expectedActualValue("2")
                .addTest()
            .newTest((expression, value) -> expression.doesNotHaveAtIndex("c", 0))
                .testCaseName("[doesNotHaveAtIndex:string] Has letter at index")
                .value("cba")
                .expectedState(FAILED)
                .expectedName("indexOf[" + 'c' + "] != " + 0)
                .expectedExpectedValue("not[0]")
                .expectedActualValue("0")
                .addTest()
            .newTest((expression, value) -> expression.doesNotHaveAtIndex("z", 0))
                .testCaseName("[doesNotHaveAtIndex:string] Does not have letter")
                .value("cba")
                .expectedState(PASSED)
                .expectedName("indexOf[" + 'z' + "] != " + 0)
                .expectedExpectedValue("not[0]")
                .expectedActualValue("-1")
                .addTest()
            .newTest((expression, value) -> expression.doesNotHaveAtIndex("c", 0))
                .testCaseName("[doesNotHaveAtIndex:string] First index matches")
                .value("cabc")
                .expectedState(FAILED)
                .expectedName("indexOf[" + 'c' + "] != " + 0)
                .expectedExpectedValue("not[0]")
                .expectedActualValue("0")
                .addTest();
    }

    private void hasAtLastIndexTestCases(ExpressionTestCaseBuilder<String, StringExpression> builder) {
        builder.newTest((expression, value) -> expression.hasAtLastIndex('c', 0))
                .testCaseName("[hasAtLastIndex:char] Has letter but not at index")
                .value("abc")
                .expectedState(FAILED)
                .expectedName("lastIndexOf[" + 'c' + "] := " + 0)
                .expectedExpectedValue("0")
                .expectedActualValue("2")
                .addTest()
            .newTest((expression, value) -> expression.hasAtLastIndex('c', 0))
                .testCaseName("[hasAtLastIndex:char] Has letter at index")
                .value("cba")
                .expectedState(PASSED)
                .expectedName("lastIndexOf[" + 'c' + "] := " + 0)
                .expectedExpectedValue("0")
                .expectedActualValue("0")
                .addTest()
            .newTest((expression, value) -> expression.hasAtLastIndex('z', 0))
                .testCaseName("[hasAtLastIndex:char] Does not have letter")
                .value("cba")
                .expectedState(FAILED)
                .expectedName("lastIndexOf[" + 'z' + "] := " + 0)
                .expectedExpectedValue("0")
                .expectedActualValue("-1")
                .addTest()
            .newTest((expression, value) -> expression.hasAtLastIndex('c', 0))
                .testCaseName("[hasAtLastIndex:char] First index matches")
                .value("cabc")
                .expectedState(FAILED)
                .expectedName("lastIndexOf[" + 'c' + "] := " + 0)
                .expectedExpectedValue("0")
                .expectedActualValue("3")
                .addTest()
            .newTest((expression, value) -> expression.hasAtLastIndex("c", 0))
                .testCaseName("[hasAtLastIndex:char] Has letter but not at index")
                .value("abc")
                .expectedState(FAILED)
                .expectedName("lastIndexOf[" + 'c' + "] := " + 0)
                .expectedExpectedValue("0")
                .expectedActualValue("2")
                .addTest()
            .newTest((expression, value) -> expression.hasAtLastIndex("c", 0))
                .testCaseName("[hasAtLastIndex:string] Has letter at index")
                .value("cba")
                .expectedState(PASSED)
                .expectedName("lastIndexOf[" + 'c' + "] := " + 0)
                .expectedExpectedValue("0")
                .expectedActualValue("0")
                .addTest()
            .newTest((expression, value) -> expression.hasAtLastIndex("z", 0))
                .testCaseName("[hasAtLastIndex:string] Does not have letter")
                .value("cba")
                .expectedState(FAILED)
                .expectedName("lastIndexOf[" + 'z' + "] := " + 0)
                .expectedExpectedValue("0")
                .expectedActualValue("-1")
                .addTest()
            .newTest((expression, value) -> expression.hasAtLastIndex("c", 0))
                .testCaseName("[hasAtLastIndex:string] First index matches")
                .value("cabc")
                .expectedState(FAILED)
                .expectedName("lastIndexOf[" + 'c' + "] := " + 0)
                .expectedExpectedValue("0")
                .expectedActualValue("3")
                .addTest();
    }

    private void doesNotHaveAtLastIndexTestCases(ExpressionTestCaseBuilder<String, StringExpression> builder) {
        builder.newTest((expression, value) -> expression.doesNotHaveAtLastIndex('c', 0))
                .testCaseName("[doesNotHaveAtLastIndex:char] Has letter but not at index")
                .value("abc")
                .expectedState(PASSED)
                .expectedName("lastIndexOf[" + 'c' + "] != " + 0)
                .expectedExpectedValue("not[0]")
                .expectedActualValue("2")
                .addTest()
            .newTest((expression, value) -> expression.doesNotHaveAtLastIndex('c', 0))
                .testCaseName("[doesNotHaveAtLastIndex:char] Has letter at index")
                .value("cba")
                .expectedState(FAILED)
                .expectedName("lastIndexOf[" + 'c' + "] != " + 0)
                .expectedExpectedValue("not[0]")
                .expectedActualValue("0")
                .addTest()
            .newTest((expression, value) -> expression.doesNotHaveAtLastIndex('z', 0))
                .testCaseName("[doesNotHaveAtLastIndex:char] Does not have letter")
                .value("cba")
                .expectedState(PASSED)
                .expectedName("lastIndexOf[" + 'z' + "] != " + 0)
                .expectedExpectedValue("not[0]")
                .expectedActualValue("-1")
                .addTest()
            .newTest((expression, value) -> expression.doesNotHaveAtLastIndex('c', 0))
                .testCaseName("[hasAtLastIndex:char] First index matches")
                .value("cabc")
                .expectedState(PASSED)
                .expectedName("lastIndexOf[" + 'c' + "] != " + 0)
                .expectedExpectedValue("not[0]")
                .expectedActualValue("3")
                .addTest()
            .newTest((expression, value) -> expression.doesNotHaveAtLastIndex("c", 0))
                .testCaseName("[doesNotHaveAtLastIndex:string] Has letter but not at index")
                .value("abc")
                .expectedState(PASSED)
                .expectedName("lastIndexOf[" + 'c' + "] != " + 0)
                .expectedExpectedValue("not[0]")
                .expectedActualValue("2")
                .addTest()
            .newTest((expression, value) -> expression.doesNotHaveAtLastIndex("c", 0))
                .testCaseName("[doesNotHaveAtLastIndex:string] Has letter at index")
                .value("cba")
                .expectedState(FAILED)
                .expectedName("lastIndexOf[" + 'c' + "] != " + 0)
                .expectedExpectedValue("not[0]")
                .expectedActualValue("0")
                .addTest()
            .newTest((expression, value) -> expression.doesNotHaveAtLastIndex("z", 0))
                .testCaseName("[doesNotHaveAtLastIndex:string] Does not have letter")
                .value("cba")
                .expectedState(PASSED)
                .expectedName("lastIndexOf[" + 'z' + "] != " + 0)
                .expectedExpectedValue("not[0]")
                .expectedActualValue("-1")
                .addTest()
            .newTest((expression, value) -> expression.doesNotHaveAtLastIndex("c", 0))
                .testCaseName("[hasAtLastIndex:string] First index matches")
                .value("cabc")
                .expectedState(PASSED)
                .expectedName("lastIndexOf[" + 'c' + "] != " + 0)
                .expectedExpectedValue("not[0]")
                .expectedActualValue("3")
                .addTest();
    }
}
